from django.shortcuts import render
from myajaxsang.models import Sangdata
from django.http.response import HttpResponse
import json

# Create your views here.
def MainFunc(request):
    return render(request, 'main.html')

def ListFunc(request):
    # 네이버 기계번역 API 예제
    import os
    import sys
    import urllib.request
    client_id = "DkodM1tyccTHD2Qu6kdZ"
    client_secret = "7qajBGO7at"
    encText = urllib.parse.quote("번역할 문장을 입력하세요")
    data = "source=ko&target=en&text=" + encText
    url = "https://openapi.naver.com/v1/language/translate"
    request = urllib.request.Request(url)
    request.add_header("X-Naver-Client-Id",client_id)
    request.add_header("X-Naver-Client-Secret",client_secret)
    response = urllib.request.urlopen(request, data=data.encode("utf-8"))
    rescode = response.getcode()
    if(rescode==200):
        response_body = response.read()
        print(response_body.decode('utf-8'))
    else:
        print("Error Code:" + rescode)
    return render(request, 'list.html')

def ListDbFunc(request):
    sdata = Sangdata.objects.all()
    
    datas = []
    for s in sdata:
        dic = {'code' : s.code, 'sang' : s.sang, 'su' : s.su, 'dan' : s.dan}
        datas.append(dic)
    
    #print(datas)
    return HttpResponse(json.dumps(datas), content_type = 'application/json')