# K-fold cross validation (k겹 교차검증) : 적은 양의 데이터로 과적합 방지가 가능한 모델 생성
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.wrappers.scikit_learn import KerasClassifier
from sklearn.model_selection import KFold, cross_val_score
import numpy as np
dataset = np.loadtxt('https://raw.githubusercontent.com/pykwon/python/master/testdata_utf8/diabetes.csv', delimiter = ',')

x = dataset[:, 0:-1]
y = dataset[:, -1]
print(x[:3])
print(y[:3])

model = Sequential([
    Dense(units=64, input_dim = 8, activation = 'relu'),
    Dense(units=32, activation = 'relu'),    
    Dense(units=1, activation = 'sigmoid'),
])

model.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])

